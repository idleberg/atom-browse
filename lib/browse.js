"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("atom"),n=require("path"),r=e(n),o=require("os"),a=require("util"),i=e(a),s=require("electron"),c=require("child_process"),u=require("fs"),l=e(u);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function d(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))}function p(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var f=a.promisify(u.access),m=a.promisify(c.spawn),h=a.promisify(u.stat),v=function(e){return void 0===e&&(e=""),atom.config.get("browse."+e)},y=function(){switch(o.platform()){case"darwin":return"Finder";case"win32":return"Explorer";default:return"file manager"}},w=function(e,t){return d(void 0,void 0,void 0,(function(){var n,r,o,a;return p(this,(function(i){switch(i.label){case 0:return(n=!t.length)?[3,2]:[4,(c=t,d(void 0,void 0,void 0,(function(){var e;return p(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,h(c)];case 1:return e=t.sent(),[3,3];case 2:return t.sent(),atom.inDevMode()&&console.warn("browse: Skipping '"+c+"' – not found"),[2,!1];case 3:return[2,e.isDirectory()]}}))})))];case 1:n=!i.sent(),i.label=2;case 2:return n||((r=v("customFileManager.fullPath"))?((o=v("customFileManager.openArgs")).length>0?o.includes("%path%")?(a=o.indexOf("%path%"),o[a]=o[a].replace("%path%",t)):o.push(t):o=[t],g("Opening "+e+" in custom file manager"),m(r,o,{})):(g("Opening "+e+" in "+y()),s.shell.openItem(t))),[2]}var c}))}))},g=function(e,t){void 0===t&&(t=!1),"all"===v("notify")&&atom.notifications.addInfo("**browse**: "+e,{dismissable:t,icon:"check"}),atom.inDevMode()&&console.info("browse: "+e)},b=function(e,t){void 0===t&&(t=!1),"none"!==v("notify")&&atom.notifications.addWarning("**browse**: "+e,{dismissable:t}),v("beep")&&atom.beep(),atom.inDevMode()&&console.warn("browse: "+e)};const k=(e,...t)=>new Promise(n=>{n(e(...t))});var P=k,A=k;P.default=A;const x=e=>{if(!Number.isInteger(e)&&e!==1/0||!(e>0))return Promise.reject(new TypeError("Expected `concurrency` to be a number from 1 and up"));const t=[];let n=0;const r=()=>{n--,t.length>0&&t.shift()()},o=(e,t,...o)=>{n++;const a=P(e,...o);t(a),a.then(r,r)},a=(r,...a)=>new Promise(i=>((r,a,...i)=>{n<e?o(r,a,...i):t.push(o.bind(null,r,a,...i))})(r,i,...a));return Object.defineProperties(a,{activeCount:{get:()=>n},pendingCount:{get:()=>t.length}}),a};var F=x,S=x;F.default=S;class E extends Error{constructor(e){super(),this.value=e}}const D=async(e,t)=>t(await e),j=async e=>{const t=await Promise.all(e);if(!0===t[1])throw new E(t[0]);return!1},O=async(e,t,n)=>{n={concurrency:1/0,preserveOrder:!0,...n};const r=F(n.concurrency),o=[...e].map(e=>[e,r(D,e,t)]),a=F(n.preserveOrder?1:1/0);try{await Promise.all(o.map(e=>a(j,e)))}catch(e){if(e instanceof E)return e.value;throw e}};var M=O,I=O;M.default=I;const{promisify:q}=i,C=q(l.stat),N=q(l.lstat),R={directory:"isDirectory",file:"isFile"};function T({type:e}){if(!(e in R))throw new Error("Invalid type specified: "+e)}const _=(e,t)=>void 0===e||t[R[e]]();var B=async(e,t)=>{T(t={cwd:process.cwd(),type:"file",allowSymlinks:!0,...t});const n=t.allowSymlinks?C:N;return M(e,async e=>{try{const o=await n(r.resolve(t.cwd,e));return _(t.type,o)}catch(e){return!1}},t)};B.sync=(e,t)=>{T(t={cwd:process.cwd(),allowSymlinks:!0,type:"file",...t});const n=t.allowSymlinks?l.statSync:l.lstatSync;for(const o of e)try{const e=n(r.resolve(t.cwd,o));if(_(t.type,e))return o}catch(e){}};const{promisify:W}=i,U=W(l.access);var G=async e=>{try{return await U(e),!0}catch(e){return!1}};G.sync=e=>{try{return l.accessSync(e),!0}catch(e){return!1}};var H,L=function(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}((function(e){const t=Symbol("findUp.stop");e.exports=async(e,n={})=>{let o=r.resolve(n.cwd||"");const{root:a}=r.parse(o),i=[].concat(e),s=async t=>{if("function"!=typeof e)return B(i,t);const n=await e(t.cwd);return"string"==typeof n?B([n],t):n};for(;;){const e=await s({...n,cwd:o});if(e===t)return;if(e)return r.resolve(o,e);if(o===a)return;o=r.dirname(o)}},e.exports.sync=(e,n={})=>{let o=r.resolve(n.cwd||"");const{root:a}=r.parse(o),i=[].concat(e),s=t=>{if("function"!=typeof e)return B.sync(i,t);const n=e(t.cwd);return"string"==typeof n?B.sync([n],t):n};for(;;){const e=s({...n,cwd:o});if(e===t)return;if(e)return r.resolve(o,e);if(o===a)return;o=r.dirname(o)}},e.exports.exists=G,e.exports.sync.exists=G.sync,e.exports.stop=t})),z=function(){atom.packages.getPackageDirPaths().filter((function(e){return!e.includes("app.asar")})).forEach((function(e){w("Packages Folder",e)}))},J=function(e){return d(void 0,void 0,void 0,(function(){var t,r;return p(this,(function(o){return!(t=e||atom.workspace.getActivePaneItem())||"TextEditor"!==t.constructor.name&&"ImageEditor"!==t.constructor.name?b("Active pane is not an editor"):(r=t.buffer.file?t.buffer.file.path:"")?function(e){d(void 0,void 0,void 0,(function(){var t,r,o,a;return p(this,(function(i){switch(i.label){case 0:return(t=!e.length)?[3,2]:[4,(c=e,d(void 0,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,f(c)];case 1:return e.sent(),[3,3];case 2:return e.sent(),atom.inDevMode()&&console.warn("browse: Skipping '"+c+"' – not found"),[2,!1];case 3:return[2,!0]}}))})))];case 1:t=!i.sent(),i.label=2;case 2:return t||((r=v("customFileManager.fullPath"))?((o=v("customFileManager.revealArgs")).length>0?o.includes("%path%")?(a=o.indexOf("%path%"),o[a]=o[a].replace("%path%",e)):o.push(e):o=[e],g("Revealing `"+n.basename(e)+"` in custom file manager"),m(r,o,{})):(g("Revealing `"+n.basename(e)+"` in "+y()),s.shell.showItemInFolder(e))),[2]}var c}))}))}(r):b("File hasn't been saved yet"),[2]}))}))},K={notify:{title:"Notifications",description:"Specify which types of notifications to display",type:"string",enum:[{value:"none",description:"None"},{value:"warnings",description:"Warnings Only"},{value:"all",description:"All Notifications"}],default:"all",order:1},dependencyPaths:{title:"Dependency Paths",description:"Specify dependency folders that can be opened using the *Browse: Dependency Folders* command",type:"array",default:["bower_components","node_modules","vendor"],items:{type:["string"]},order:2},beep:{title:"Beep on error",description:"Play beep sound when errors occur",type:"boolean",default:!0,order:3},openAppPackage:function(){if("darwin"===o.platform()){var e=void 0;switch(atom.getReleaseChannel()){case"beta":e="Atom Beta";break;case"nightly":e="Atom Nightly";break;default:e="Atom"}return{title:"Open App Package",description:"Specify whether *Browse: Application Folder* opens the `"+e+".app` package or the executable that started the Node.js process (i.e. `Atom Helper`)",type:"boolean",default:!0,order:3}}return{}}(),customFileManager:{title:"Custom File Manager Options",type:"object",order:5,properties:{fullPath:{title:"Full Path",description:"Specify the full path to a custom file manager",type:"string",default:"",order:1},openArgs:{title:"Open Arguments",description:"Specify custom arguments to open a folder. The use of the `%path%` placeholder is optional.",type:"array",default:[],items:{type:["string","integer"]},order:2},revealArgs:{title:"Reveal Arguments",description:"Specify custom arguments to reveal a file. The use of the `%path%` placeholder is optional.",type:"array",default:[],items:{type:["string","integer"]},order:3}}}};exports.activate=function(){return d(this,void 0,void 0,(function(){return p(this,(function(e){return(H=new t.CompositeDisposable).add(atom.commands.add("atom-workspace",{"browse:.apm-folder":function(){var e,t;e=n.dirname(atom.config.getUserConfigPath()),t=n.resolve(e,".apm"),w(".apm Folder",t)}})),H.add(atom.commands.add("atom-workspace",{"browse:application-folder":function(){d(void 0,void 0,void 0,(function(){var e,t,r;return p(this,(function(a){return e=n.dirname(n.resolve(process.execPath)),"darwin"===o.platform()&&v("openAppPackage")?(r=L.sync("Resources",{cwd:e,type:"directory"}),t=r?n.dirname(r):e):t=e,w("Application Folder",t),[2]}))}))}})),H.add(atom.commands.add("atom-workspace",{"browse:configuration-folder":function(){var e;e=n.dirname(atom.config.getUserConfigPath()),w("Configuration Folder",e)}})),H.add(atom.commands.add("atom-workspace",{"browse:app-data-folder":function(){d(void 0,void 0,void 0,(function(){var e;return p(this,(function(t){switch(o.platform()){case"darwin":e=n.resolve(o.homedir(),"Library","Application Support","Atom");break;case"win32":e=process.env.APPDATA?n.resolve(process.env.APPDATA,"Atom"):"";break;default:e=n.resolve(o.homedir(),".config","Atom")}return w("App Data Folder",e),[2]}))}))}})),H.add(atom.commands.add("atom-workspace",{"browse:packages-folder":function(){z()}})),H.add(atom.commands.add("atom-workspace",{"browse:project-folders":function(){d(void 0,void 0,void 0,(function(){var e;return p(this,(function(t){return 0===(e=atom.project.getPaths()).length?[2,b("Editor has no projects")]:(e.forEach((function(e){e.startsWith("atom://")||w("Project Folder",e)})),[2])}))}))}})),H.add(atom.commands.add("atom-workspace",{"browse:project-dependencies":function(){d(void 0,void 0,void 0,(function(){var e,t;return p(this,(function(r){return 0===(e=atom.project.getPaths()).length?[2,b("Editor has no projects")]:(t=v("dependencyPaths"))&&t.length?(e.forEach((function(e){e.startsWith("atom://")||t.forEach((function(t){return d(void 0,void 0,void 0,(function(){var r;return p(this,(function(o){return r=n.resolve(e,t),w("`"+t+"`",r),[2]}))}))}))})),[2]):[2,b("No dependency folders specified in package configuration")]}))}))}})),H.add(atom.commands.add("atom-workspace",{"browse:resources-folder":function(){d(void 0,void 0,void 0,(function(){var e;return p(this,(function(t){return e=atom.commandInstaller.getResourcesDirectory(),w("Resources Folder",e),[2]}))}))}})),H.add(atom.commands.add("atom-workspace",{"browse:reveal-open-files":function(){var e;(e=atom.workspace.getPaneItems()).length?e.forEach((function(e){J(e)})):b("No active files")}})),H.add(atom.commands.add("atom-workspace",{"browse:reveal-file":function(){J()}})),[2]}))}))},exports.config=K,exports.deactivate=function(){H&&H.dispose()};
//# sourceMappingURL=browse.js.map
