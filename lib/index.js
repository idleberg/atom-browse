'use strict';var child_process=require('child_process'),os=require('os'),path=require('path'),electron=require('electron'),fs=require('fs'),atom$1=require('atom');var Ie=Object.create;var $=Object.defineProperty;var Me=Object.getOwnPropertyDescriptor;var Oe=Object.getOwnPropertyNames;var je=Object.getPrototypeOf,Te=Object.prototype.hasOwnProperty;var w=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var p=(e,t)=>()=>(e&&(t=e(e=0)),t);var y=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),m=(e,t)=>{for(var r in t)$(e,r,{get:t[r],enumerable:true});},Ce=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of Oe(t))!Te.call(e,a)&&a!==r&&$(e,a,{get:()=>t[a],enumerable:!(n=Me(t,a))||n.enumerable});return e};var Ee=(e,t,r)=>(r=e!=null?Ie(je(e)):{},Ce(!e||!e.__esModule?$(r,"default",{value:e,enumerable:true}):r,e));var z,N=p(()=>{z=class{name;styleSheet;constructor(e,t={}){if(typeof e!="string")throw new TypeError(`DeveloperConsole: name must be a string, got "${typeof e}"`);this.name=e,this.styleSheet=`
      background-color: ${t.backgroundColor||"darkgrey"};
      border-radius: 2px;
      color: ${t.color||"white"};
      line-height: 1.5;
      padding: 1px 4px;
      text-shadow: 0 1px 0px rgba(0, 0, 0, 0.2);
    `;}__console__(e,...t){atom!=null&&atom.inDevMode()&&(t.unshift(`%c${this.name}%c`,this.styleSheet,""),globalThis.console[e](...t));}debug(...e){this.__console__("debug",...e);}error(...e){this.__console__("error",...e);}info(...e){this.__console__("info",...e);}log(...e){this.__console__("log",...e);}trace(...e){this.__console__("trace",...e);}warn(...e){this.__console__("warn",...e);}};});var P,q=p(()=>{P="browse";});var l,F=p(()=>{N();q();l=new z(P,{backgroundColor:"mediumseagreen"});});var d={};m(d,{PLATFORM:()=>g,fileExists:()=>W,folderExists:()=>H,getAppName:()=>We,getConfig:()=>f,getPackagesDirs:()=>He,info:()=>x,isDirectory:()=>Be,isFile:()=>Ue,showFolder:()=>Ke,showInFolder:()=>Qe,warn:()=>Ge});function U(e,t){child_process.spawn(e,t,{detached:true,stdio:"ignore"}).unref();}async function W(e){try{await fs.promises.access(e,fs.constants.F_OK);}catch{return l.warn(`Skipping '${e}' \u2013 not found`),false}return  true}async function Be(e){try{return (await fs.promises.lstat(e)).isDirectory()}catch{return  false}}async function Ue(e){try{return (await fs.promises.lstat(e)).isFile()}catch{return  false}}async function H(e){try{return (await fs.promises.stat(e)).isDirectory()}catch{return l.warn(`Skipping '${e}' \u2013 not found`),false}}async function Ke(e){var n,a,i,s;let t=typeof e=="string"?e:e.path;if(!t.length||!await H(t))return;let r=f("customFileManager.fullPath");if(r){let o=f("customFileManager.openArgs");if(o.length>0)if(o.includes("%path%")){let u=o.indexOf("%path%");o[u]=o[u].replace("%path%",t);}else o.push(t);else o=[t];typeof e!="string"&&!(e!=null&&e.silent)&&((n=e==null?void 0:e.message)!=null&&n.length)&&((a=e==null?void 0:e.name)!=null&&a.length)&&x(e.message?String(e.message):`Opening '${e.name}' in custom file manager`),U(r,o);}else {typeof e!="string"&&!(e!=null&&e.silent)&&((i=e==null?void 0:e.message)!=null&&i.length)&&((s=e==null?void 0:e.name)!=null&&s.length)&&x(e.message?String(e.message):`Opening '${e.name}' in ${K()}`);try{await electron.shell.openPath(t);}catch{"openItem"in electron.shell&&electron.shell.openItem(t);}}}async function Qe(e){var n,a;let t=typeof e=="string"?e:e.path;if(!t.length||!await W(t))return;let r=f("customFileManager.fullPath");if(r){let i=f("customFileManager.revealArgs");if(i.length>0)if(i.includes("%path%")){let s=i.indexOf("%path%");i[s]=i[s].replace("%path%",t);}else i.push(t);else i=[t];typeof e!="string"&&!(e!=null&&e.silent)&&((n=e==null?void 0:e.message)!=null&&n.length)&&x(e.message?String(e.message):`Revealing \`${path.basename(t)}\` in custom file manager`),U(r,i);}else typeof e!="string"&&!(e!=null&&e.silent)&&((a=e==null?void 0:e.message)!=null&&a.length)&&x(e.message?String(e.message):`Revealing \`${path.basename(t)}\` in ${K()}`),electron.shell.showItemInFolder(t);}function x(e,t=false){f("notify")==="all"&&atom.notifications.addInfo(`**${P}** ${e}`,{dismissable:t,icon:"check"}),l.info(`${e}`);}function Ge(e,t=false){f("notify")!=="none"&&atom.notifications.addWarning(`**${P}** ${e}`,{dismissable:t}),f("beep")&&atom.beep(),l.warn(`${e}`);}var g,We,f,He,K,c=p(()=>{q();F();g=os.platform();We=()=>atom.getAppName().split(" ")[0]||"",f=(e="")=>atom.config.get(`browse.${e}`),He=()=>atom.packages.getPackageDirPaths().filter(t=>!t.includes("app.asar")),K=()=>{switch(g){case "darwin":return "Finder";case "win32":return "Explorer";default:return "file manager"}};});var J={};m(J,{apmFolder:()=>Ye});async function Ye(){let{showFolder:e}=await Promise.resolve().then(()=>(c(),d)),t=path.dirname(atom.config.getUserConfigPath()),r=path.resolve(t,".apm");e({name:".apm Folder",path:r});}var V=p(()=>{});var Y={};m(Y,{appDataFolder:()=>Ze});async function Ze(){let{getAppName:e,showFolder:t}=await Promise.resolve().then(()=>(c(),d)),r=e(),n;switch(g){case "darwin":n=path.resolve(os.homedir(),"Library","Application Support",r);break;case "win32":n=process.env.APPDATA?path.resolve(process.env.APPDATA,r):"";break;default:n=path.resolve(os.homedir(),".config",r);break}t({name:"App Data Folder",path:n});}var Z=p(()=>{c();});var te=y((Ut,ee)=>{var M=class{constructor(t){this.value=t,this.next=void 0;}},O=class{constructor(){this.clear();}enqueue(t){let r=new M(t);this._head?(this._tail.next=r,this._tail=r):(this._head=r,this._tail=r),this._size++;}dequeue(){let t=this._head;if(t)return this._head=this._head.next,this._size--,t.value}clear(){this._head=void 0,this._tail=void 0,this._size=0;}get size(){return this._size}*[Symbol.iterator](){let t=this._head;for(;t;)yield t.value,t=t.next;}};ee.exports=O;});var se=y((Wt,re)=>{var et=te(),tt=e=>{if(!((Number.isInteger(e)||e===1/0)&&e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");let t=new et,r=0,n=()=>{r--,t.size>0&&t.dequeue()();},a=async(o,u,...b)=>{r++;let L=(async()=>o(...b))();u(L);try{await L;}catch{}n();},i=(o,u,...b)=>{t.enqueue(a.bind(null,o,u,...b)),(async()=>(await Promise.resolve(),r<e&&t.size>0&&t.dequeue()()))();},s=(o,...u)=>new Promise(b=>{i(o,b,...u);});return Object.defineProperties(s,{activeCount:{get:()=>r},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear();}}}),s};re.exports=tt;});var ie=y((Ht,ae)=>{var ne=se(),A=class extends Error{constructor(t){super(),this.value=t;}},rt=async(e,t)=>t(await e),st=async e=>{let t=await Promise.all(e);if(t[1]===true)throw new A(t[0]);return  false},nt=async(e,t,r)=>{r={concurrency:1/0,preserveOrder:true,...r};let n=ne(r.concurrency),a=[...e].map(s=>[s,n(rt,s,t)]),i=ne(r.preserveOrder?1:1/0);try{await Promise.all(a.map(s=>i(st,s)));}catch(s){if(s instanceof A)return s.value;throw s}};ae.exports=nt;});var me=y((Kt,j)=>{var oe=w("path"),S=w("fs"),{promisify:ce}=w("util"),at=ie(),it=ce(S.stat),ot=ce(S.lstat),le={directory:"isDirectory",file:"isFile"};function pe({type:e}){if(!(e in le))throw new Error(`Invalid type specified: ${e}`)}var de=(e,t)=>e===void 0||t[le[e]]();j.exports=async(e,t)=>{t={cwd:process.cwd(),type:"file",allowSymlinks:true,...t},pe(t);let r=t.allowSymlinks?it:ot;return at(e,async n=>{try{let a=await r(oe.resolve(t.cwd,n));return de(t.type,a)}catch{return  false}},t)};j.exports.sync=(e,t)=>{t={cwd:process.cwd(),allowSymlinks:true,type:"file",...t},pe(t);let r=t.allowSymlinks?S.statSync:S.lstatSync;for(let n of e)try{let a=r(oe.resolve(t.cwd,n));if(de(t.type,a))return n}catch{}};});var fe=y((Qt,T)=>{var ue=w("fs"),{promisify:ct}=w("util"),lt=ct(ue.access);T.exports=async e=>{try{return await lt(e),!0}catch{return  false}};T.exports.sync=e=>{try{return ue.accessSync(e),!0}catch{return  false}};});var he=y((Gt,v)=>{var h=w("path"),D=me(),ge=fe(),C=Symbol("findUp.stop");v.exports=async(e,t={})=>{let r=h.resolve(t.cwd||""),{root:n}=h.parse(r),a=[].concat(e),i=async s=>{if(typeof e!="function")return D(a,s);let o=await e(s.cwd);return typeof o=="string"?D([o],s):o};for(;;){let s=await i({...t,cwd:r});if(s===C)return;if(s)return h.resolve(r,s);if(r===n)return;r=h.dirname(r);}};v.exports.sync=(e,t={})=>{let r=h.resolve(t.cwd||""),{root:n}=h.parse(r),a=[].concat(e),i=s=>{if(typeof e!="function")return D.sync(a,s);let o=e(s.cwd);return typeof o=="string"?D.sync([o],s):o};for(;;){let s=i({...t,cwd:r});if(s===C)return;if(s)return h.resolve(r,s);if(r===n)return;r=h.dirname(r);}};v.exports.exists=ge;v.exports.sync.exists=ge.sync;v.exports.stop=C;});var ye={};m(ye,{appFolder:()=>dt});async function dt(){let{getConfig:e,showFolder:t}=await Promise.resolve().then(()=>(c(),d)),r=await Promise.resolve().then(()=>Ee(he())),n=path.dirname(path.resolve(process.execPath)),a;if(g==="darwin"&&e("openAppPackage")){let i=r.sync("Resources",{cwd:n,type:"directory"});a=i?path.dirname(i):n;}else a=n;t({name:"Application Folder",path:a});}var ve=p(()=>{c();});var be={};m(be,{configFolder:()=>ut});async function ut(){let{showFolder:e}=await Promise.resolve().then(()=>(c(),d)),t=path.dirname(atom.config.getUserConfigPath());e({name:"Configuration Folder",path:t});}var Pe=p(()=>{});var xe={};m(xe,{packagesFolder:()=>ft});async function ft(){let{getPackagesDirs:e,showFolder:t}=await Promise.resolve().then(()=>(c(),d)),r=e();for(let n of r)t({name:"Packages Folder",path:n});}var Fe=p(()=>{});var ke={};m(ke,{projectFolders:()=>gt});async function gt(){let{showFolder:e,warn:t}=await Promise.resolve().then(()=>(c(),d)),r=atom.project.getPaths();if(r.length===0)return t("Editor has no projects");for(let n of r)n.startsWith("atom://")||e({name:"Project Folder",path:n});}var _e=p(()=>{});var Ae={};m(Ae,{projectDependencies:()=>wt});async function wt(){let{getConfig:e,showFolder:t,warn:r}=await Promise.resolve().then(()=>(c(),d)),n=atom.project.getPaths();if(n.length===0)return r("Editor has no projects");let a=e("dependencyPaths");if(!a||!a.length)return r("No dependency folders specified in package configuration");await Promise.all(n.map(async i=>{i.startsWith("atom://")||await Promise.all(a.map(async s=>{let o=path.resolve(i,s);t({name:`\`${s}\``,path:o});}));}));}var Se=p(()=>{});var De={};m(De,{resourcesFolder:()=>yt});async function yt(){let{showFolder:e}=await Promise.resolve().then(()=>(c(),d)),t=atom.commandInstaller.getResourcesDirectory();e({name:"Resources Folder",path:t});}var $e=p(()=>{});var E={};m(E,{revealFile:()=>qe,revealFiles:()=>vt});async function qe(e){var a,i;let{showInFolder:t,warn:r}=await Promise.resolve().then(()=>(c(),d)),n=e||atom.workspace.getActiveTextEditor()||atom.workspace.getActivePaneItem();if(n&&(n.constructor.name==="TextEditor"||n.constructor.name==="ImageEditor")){let s=((i=(a=n.buffer)==null?void 0:a.file)==null?void 0:i.path)??"";s?t({path:s}):r("File hasn't been saved yet");}else r("Active pane is not an editor");}async function vt(){let{warn:e}=await Promise.resolve().then(()=>(c(),d)),t=atom.workspace.getPaneItems();t.length?await Promise.all(t.map(r=>qe(r))):e("No active files");}var R=p(()=>{});F();async function Q(e){let{isDirectory:t,isFile:r,showFolder:n,showInFolder:a}=await Promise.resolve().then(()=>(c(),d));typeof e=="string"?(l.log("Auto-handle string input"),e={action:await r(e)?"reveal":"open",target:e}):e!=null&&e.action&&["reveal","open"].includes(e==null?void 0:e.action)&&l.warn("payload.action is deprecated and can be omitted");let i=Array.isArray(e.target)?e.target:[e.target];await Promise.all(i.map(async s=>{if(typeof s!="string"&&l.warn(`Skipping: target path is of type ${typeof s}, should be string`),e.action==="reveal"||await r(s))a({path:s,message:e.message,silent:e.silent});else if(e.action==="open"||await t(s)){let{basename:o}=await import('path');n({name:o(s),path:s,message:e.message,silent:e.silent});}else e.action&&l.warn(`Action '${e.action}' is not supported`);}));}c();function Je(){return g?{title:"Open App Package",description:`Specify whether *Browse: Application Folder* opens the \`${atom.getAppName()}.app\` package or the executable that started the Node.js process (i.e. \`Atom Helper\`)`,type:"boolean",default:true,order:3}:{}}var G={notify:{title:"Notifications",description:"Specify which types of notifications to display",type:"string",enum:[{value:"none",description:"None"},{value:"warnings",description:"Warnings Only"},{value:"all",description:"All Notifications"}],default:"all",order:1},dependencyPaths:{title:"Dependency Paths",description:"Specify dependency folders that can be opened using the *Browse: Dependency Folders* command",type:"array",default:["bower_components","node_modules","vendor"],items:{type:["string"]},order:2},beep:{title:"Beep on error",description:"Play beep sound when errors occur",type:"boolean",default:true,order:3},openAppPackage:Je(),customFileManager:{title:"Custom File Manager Options",type:"object",order:5,properties:{fullPath:{title:"Full Path",description:"Specify the full path to a custom file manager",type:"string",default:"",order:1},openArgs:{title:"Open Arguments",description:"Specify custom arguments to open a folder. The use of the `%path%` placeholder is optional.",type:"array",default:[],items:{type:["string","integer"]},order:2},revealArgs:{title:"Reveal Arguments",description:"Specify custom arguments to reveal a file. The use of the `%path%` placeholder is optional.",type:"array",default:[],items:{type:["string","integer"]},order:3}}}};F();var sr={config:G,subscriptions:new atom$1.CompositeDisposable,async activate(){l.log("Activating package"),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:.apm-folder":async()=>{let{apmFolder:e}=await Promise.resolve().then(()=>(V(),J));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:app-data-folder":async()=>{let{appDataFolder:e}=await Promise.resolve().then(()=>(Z(),Y));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:application-folder":async()=>{let{appFolder:e}=await Promise.resolve().then(()=>(ve(),ye));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:configuration-folder":async()=>{let{configFolder:e}=await Promise.resolve().then(()=>(Pe(),be));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:packages-folder":async()=>{let{packagesFolder:e}=await Promise.resolve().then(()=>(Fe(),xe));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:project-folders":async()=>{let{projectFolders:e}=await Promise.resolve().then(()=>(_e(),ke));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:project-dependencies":async()=>{let{projectDependencies:e}=await Promise.resolve().then(()=>(Se(),Ae));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:resources-folder":async()=>{let{resourcesFolder:e}=await Promise.resolve().then(()=>($e(),De));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:reveal-open-files":async()=>{let{revealFiles:e}=await Promise.resolve().then(()=>(R(),E));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:reveal-file":async()=>{let{revealFile:e}=await Promise.resolve().then(()=>(R(),E));await e();}}));},deactivate(){var e;l.log("Deactivating package"),(e=this.subscriptions)==null||e.dispose();},provideBrowse(){return l.log("Providing service"),Q}};
module.exports=sr;