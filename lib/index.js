'use strict';var path=require('path'),fs=require('fs'),os=require('os'),electron=require('electron'),child_process=require('child_process'),atom$1=require('atom');var qe=Object.create;var D=Object.defineProperty;var Ie=Object.getOwnPropertyDescriptor;var Ce=Object.getOwnPropertyNames;var je=Object.getPrototypeOf,Me=Object.prototype.hasOwnProperty;var h=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var l=(e,t)=>()=>(e&&(t=e(e=0)),t);var w=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),m=(e,t)=>{for(var r in t)D(e,r,{get:t[r],enumerable:!0});},Ee=(e,t,r,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Ce(t))!Me.call(e,i)&&i!==r&&D(e,i,{get:()=>t[i],enumerable:!(a=Ie(t,i))||a.enumerable});return e};var Oe=(e,t,r)=>(r=e!=null?qe(je(e)):{},Ee(!e||!e.__esModule?D(r,"default",{value:e,enumerable:!0}):r,e));var b,$=l(()=>{b="browse";});var z,B=l(()=>{z=class{name;styleSheet;constructor(e,t={}){if(typeof e!="string")throw new TypeError(`DeveloperConsole: name must be a string, got "${typeof e}"`);this.name=e,this.styleSheet=`
      background-color: ${t.backgroundColor||"darkgrey"};
      border-radius: 2px;
      color: ${t.color||"white"};
      line-height: 1.5;
      padding: 1px 4px;
      text-shadow: 0 1px 0px rgba(0, 0, 0, 0.2);
    `;}__console__(e,...t){atom!=null&&atom.inDevMode()&&(t.unshift(`%c${this.name}%c`,this.styleSheet,""),globalThis.console[e](...t));}debug(...e){this.__console__("debug",...e);}error(...e){this.__console__("error",...e);}info(...e){this.__console__("info",...e);}log(...e){this.__console__("log",...e);}trace(...e){this.__console__("trace",...e);}warn(...e){this.__console__("warn",...e);}};});var c,P=l(()=>{$();B();c=new z(b,{backgroundColor:"mediumseagreen"});});var p={};m(p,{fileExists:()=>U,folderExists:()=>W,getAppName:()=>Ue,getConfig:()=>f,getPackagesDirs:()=>We,info:()=>x,isDirectory:()=>Le,isFile:()=>Re,showFolder:()=>He,showInFolder:()=>Ke,warn:()=>Qe});function R(e,t){child_process.spawn(e,t,{detached:!0,stdio:"ignore"}).unref();}async function U(e){try{await fs.promises.access(e,fs.constants.F_OK);}catch{return c.warn(`Skipping '${e}' \u2013 not found`),!1}return !0}async function Le(e){let t;try{t=await fs.promises.lstat(e);}catch{return !1}return t.isDirectory()}async function Re(e){let t;try{t=await fs.promises.lstat(e);}catch{return !1}return t.isFile()}async function W(e){let t;try{t=await fs.promises.stat(e);}catch{return c.warn(`Skipping '${e}' \u2013 not found`),!1}return t.isDirectory()}async function He(e){var a,i,n,s;let t=typeof e=="string"?e:e.path;if(!t.length||!await W(t))return;let r=f("customFileManager.fullPath");if(r){let o=f("customFileManager.openArgs");if(o.length>0)if(o.includes("%path%")){let u=o.indexOf("%path%");o[u]=o[u].replace("%path%",t);}else o.push(t);else o=[t];typeof e!="string"&&!(e!=null&&e.silent)&&((a=e==null?void 0:e.message)!=null&&a.length)&&((i=e==null?void 0:e.name)!=null&&i.length)&&x(e.message?String(e.message):`Opening '${e.name}' in custom file manager`),R(r,o);}else {typeof e!="string"&&!(e!=null&&e.silent)&&((n=e==null?void 0:e.message)!=null&&n.length)&&((s=e==null?void 0:e.name)!=null&&s.length)&&x(e.message?String(e.message):`Opening '${e.name}' in ${H()}`);try{await electron.shell.openPath(t);}catch{electron.shell.openItem&&electron.shell.openItem(t);}}}async function Ke(e){var a,i;let t=typeof e=="string"?e:e.path;if(!t.length||!await U(t))return;let r=f("customFileManager.fullPath");if(r){let n=f("customFileManager.revealArgs");if(n.length>0)if(n.includes("%path%")){let s=n.indexOf("%path%");n[s]=n[s].replace("%path%",t);}else n.push(t);else n=[t];typeof e!="string"&&!(e!=null&&e.silent)&&((a=e==null?void 0:e.message)!=null&&a.length)&&x(e.message?String(e.message):`Revealing \`${path.basename(t)}\` in custom file manager`),R(r,n);}else typeof e!="string"&&!(e!=null&&e.silent)&&((i=e==null?void 0:e.message)!=null&&i.length)&&x(e.message?String(e.message):`Revealing \`${path.basename(t)}\` in ${H()}`),electron.shell.showItemInFolder(t);}function x(e,t=!1){f("notify")==="all"&&atom.notifications.addInfo(`**${b}** ${e}`,{dismissable:t,icon:"check"}),c.info(`${e}`);}function Qe(e,t=!1){f("notify")!=="none"&&atom.notifications.addWarning(`**${b}** ${e}`,{dismissable:t}),f("beep")&&atom.beep(),c.warn(`${e}`);}var Ue,f,We,H,d=l(()=>{P();$();Ue=()=>atom.getAppName().split(" ")[0],f=(e="")=>atom.config.get(`browse.${e}`),We=()=>atom.packages.getPackageDirPaths().filter(t=>!t.includes("app.asar")),H=()=>{switch(os.platform()){case"darwin":return "Finder";case"win32":return "Explorer";default:return "file manager"}};});var G={};m(G,{apmFolder:()=>Ye});async function Ye(){let{showFolder:e}=await Promise.resolve().then(()=>(d(),p)),t=path.dirname(atom.config.getUserConfigPath()),r=path.resolve(t,".apm");e({name:".apm Folder",path:r});}var J=l(()=>{});var X={};m(X,{appDataFolder:()=>et});async function et(){let{getAppName:e,showFolder:t}=await Promise.resolve().then(()=>(d(),p)),r=e(),a;switch(os.platform()){case"darwin":a=path.resolve(os.homedir(),"Library","Application Support",r);break;case"win32":a=process.env.APPDATA?path.resolve(process.env.APPDATA,r):"";break;default:a=path.resolve(os.homedir(),".config",r);break}t({name:"App Data Folder",path:a});}var Y=l(()=>{});var ee=w((Wt,Z)=>{var I=class{constructor(t){this.value=t,this.next=void 0;}},C=class{constructor(){this.clear();}enqueue(t){let r=new I(t);this._head?(this._tail.next=r,this._tail=r):(this._head=r,this._tail=r),this._size++;}dequeue(){let t=this._head;if(t)return this._head=this._head.next,this._size--,t.value}clear(){this._head=void 0,this._tail=void 0,this._size=0;}get size(){return this._size}*[Symbol.iterator](){let t=this._head;for(;t;)yield t.value,t=t.next;}};Z.exports=C;});var re=w((Ht,te)=>{var tt=ee(),rt=e=>{if(!((Number.isInteger(e)||e===1/0)&&e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");let t=new tt,r=0,a=()=>{r--,t.size>0&&t.dequeue()();},i=async(o,u,...v)=>{r++;let N=(async()=>o(...v))();u(N);try{await N;}catch{}a();},n=(o,u,...v)=>{t.enqueue(i.bind(null,o,u,...v)),(async()=>(await Promise.resolve(),r<e&&t.size>0&&t.dequeue()()))();},s=(o,...u)=>new Promise(v=>{n(o,v,...u);});return Object.defineProperties(s,{activeCount:{get:()=>r},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear();}}}),s};te.exports=rt;});var ie=w((Kt,ae)=>{var se=re(),_=class extends Error{constructor(t){super(),this.value=t;}},st=async(e,t)=>t(await e),at=async e=>{let t=await Promise.all(e);if(t[1]===!0)throw new _(t[0]);return !1},it=async(e,t,r)=>{r={concurrency:1/0,preserveOrder:!0,...r};let a=se(r.concurrency),i=[...e].map(s=>[s,a(st,s,t)]),n=se(r.preserveOrder?1:1/0);try{await Promise.all(i.map(s=>n(at,s)));}catch(s){if(s instanceof _)return s.value;throw s}};ae.exports=it;});var de=w((Qt,j)=>{var ne=h("path"),A=h("fs"),{promisify:oe}=h("util"),nt=ie(),ot=oe(A.stat),ct=oe(A.lstat),ce={directory:"isDirectory",file:"isFile"};function le({type:e}){if(!(e in ce))throw new Error(`Invalid type specified: ${e}`)}var pe=(e,t)=>e===void 0||t[ce[e]]();j.exports=async(e,t)=>{t={cwd:process.cwd(),type:"file",allowSymlinks:!0,...t},le(t);let r=t.allowSymlinks?ot:ct;return nt(e,async a=>{try{let i=await r(ne.resolve(t.cwd,a));return pe(t.type,i)}catch{return !1}},t)};j.exports.sync=(e,t)=>{t={cwd:process.cwd(),allowSymlinks:!0,type:"file",...t},le(t);let r=t.allowSymlinks?A.statSync:A.lstatSync;for(let a of e)try{let i=r(ne.resolve(t.cwd,a));if(pe(t.type,i))return a}catch{}};});var ue=w((Gt,M)=>{var me=h("fs"),{promisify:lt}=h("util"),pt=lt(me.access);M.exports=async e=>{try{return await pt(e),!0}catch{return !1}};M.exports.sync=e=>{try{return me.accessSync(e),!0}catch{return !1}};});var ge=w((Jt,y)=>{var g=h("path"),S=de(),fe=ue(),E=Symbol("findUp.stop");y.exports=async(e,t={})=>{let r=g.resolve(t.cwd||""),{root:a}=g.parse(r),i=[].concat(e),n=async s=>{if(typeof e!="function")return S(i,s);let o=await e(s.cwd);return typeof o=="string"?S([o],s):o};for(;;){let s=await n({...t,cwd:r});if(s===E)return;if(s)return g.resolve(r,s);if(r===a)return;r=g.dirname(r);}};y.exports.sync=(e,t={})=>{let r=g.resolve(t.cwd||""),{root:a}=g.parse(r),i=[].concat(e),n=s=>{if(typeof e!="function")return S.sync(i,s);let o=e(s.cwd);return typeof o=="string"?S.sync([o],s):o};for(;;){let s=n({...t,cwd:r});if(s===E)return;if(s)return g.resolve(r,s);if(r===a)return;r=g.dirname(r);}};y.exports.exists=fe;y.exports.sync.exists=fe.sync;y.exports.stop=E;});var we={};m(we,{appFolder:()=>ut});async function ut(){let{getConfig:e,showFolder:t}=await Promise.resolve().then(()=>(d(),p)),r=await Promise.resolve().then(()=>Oe(ge())),a=path.dirname(path.resolve(process.execPath)),i;if(os.platform()==="darwin"&&e("openAppPackage")){let n=r.sync("Resources",{cwd:a,type:"directory"});i=n?path.dirname(n):a;}else i=a;t({name:"Application Folder",path:i});}var ye=l(()=>{});var ve={};m(ve,{configFolder:()=>gt});async function gt(){let{showFolder:e}=await Promise.resolve().then(()=>(d(),p)),t=path.dirname(atom.config.getUserConfigPath());e({name:"Configuration Folder",path:t});}var be=l(()=>{});var xe={};m(xe,{packagesFolder:()=>ht});async function ht(){let{getPackagesDirs:e,showFolder:t}=await Promise.resolve().then(()=>(d(),p));e().map(a=>{t({name:"Packages Folder",path:a});});}var Pe=l(()=>{});var ke={};m(ke,{projectFolders:()=>wt});async function wt(){let{showFolder:e,warn:t}=await Promise.resolve().then(()=>(d(),p)),r=atom.project.getPaths();if(r.length===0)return t("Editor has no projects");r.map(a=>{a.startsWith("atom://")||e({name:"Project Folder",path:a});});}var Fe=l(()=>{});var _e={};m(_e,{projectDependencies:()=>vt});async function vt(){let{getConfig:e,showFolder:t,warn:r}=await Promise.resolve().then(()=>(d(),p)),a=atom.project.getPaths();if(a.length===0)return r("Editor has no projects");let i=e("dependencyPaths");if(!i||!i.length)return r("No dependency folders specified in package configuration");await Promise.all(a.map(async n=>{n.startsWith("atom://")||await Promise.all(i.map(async s=>{let o=path.resolve(n,s);t({name:`\`${s}\``,path:o});}));}));}var Ae=l(()=>{});var Se={};m(Se,{resourcesFolder:()=>bt});async function bt(){let{showFolder:e}=await Promise.resolve().then(()=>(d(),p)),t=atom.commandInstaller.getResourcesDirectory();e({name:"Resources Folder",path:t});}var De=l(()=>{});var O={};m(O,{revealFile:()=>$e,revealFiles:()=>xt});async function $e(e){var i,n;let{showInFolder:t,warn:r}=await Promise.resolve().then(()=>(d(),p)),a=e||atom.workspace.getActiveTextEditor()||atom.workspace.getActivePaneItem();if(a&&(a.constructor.name==="TextEditor"||a.constructor.name==="ImageEditor")){let s=((n=(i=a.buffer)==null?void 0:i.file)==null?void 0:n.path)??"";s?t({path:s}):r("File hasn't been saved yet");}else r("Active pane is not an editor");}async function xt(){let{warn:e}=await Promise.resolve().then(()=>(d(),p)),t=atom.workspace.getPaneItems();t.length?await Promise.all(t.map(r=>$e(r))):e("No active files");}var T=l(()=>{});P();async function K(e){let{isDirectory:t,isFile:r,showFolder:a,showInFolder:i}=await Promise.resolve().then(()=>(d(),p));typeof e=="string"?(c.log("Auto-handle string input"),e={action:await r(e)?"reveal":"open",target:e}):e!=null&&e.action&&["reveal","open"].includes(e==null?void 0:e.action)&&c.warn("payload.action is deprecated and can be omitted");let n=Array.isArray(e.target)?e.target:[e.target];await Promise.all(n.map(async s=>{if(typeof s!="string"&&c.warn(`Skipping: target path is of type ${typeof s}, should be string`),e.action==="reveal"||await r(s))i({path:s,message:e.message,silent:e.silent});else if(e.action==="open"||await t(s)){let{basename:o}=await import('path');a({name:o(s),path:s,message:e.message,silent:e.silent});}else e.action&&c.warn(`Action '${e.action}' is not supported`);}));}P();function Je(){return os.platform()==="darwin"?{title:"Open App Package",description:`Specify whether *Browse: Application Folder* opens the \`${atom.getAppName()}.app\` package or the executable that started the Node.js process (i.e. \`Atom Helper\`)`,type:"boolean",default:!0,order:3}:{}}var Q={notify:{title:"Notifications",description:"Specify which types of notifications to display",type:"string",enum:[{value:"none",description:"None"},{value:"warnings",description:"Warnings Only"},{value:"all",description:"All Notifications"}],default:"all",order:1},dependencyPaths:{title:"Dependency Paths",description:"Specify dependency folders that can be opened using the *Browse: Dependency Folders* command",type:"array",default:["bower_components","node_modules","vendor"],items:{type:["string"]},order:2},beep:{title:"Beep on error",description:"Play beep sound when errors occur",type:"boolean",default:!0,order:3},openAppPackage:Je(),customFileManager:{title:"Custom File Manager Options",type:"object",order:5,properties:{fullPath:{title:"Full Path",description:"Specify the full path to a custom file manager",type:"string",default:"",order:1},openArgs:{title:"Open Arguments",description:"Specify custom arguments to open a folder. The use of the `%path%` placeholder is optional.",type:"array",default:[],items:{type:["string","integer"]},order:2},revealArgs:{title:"Reveal Arguments",description:"Specify custom arguments to reveal a file. The use of the `%path%` placeholder is optional.",type:"array",default:[],items:{type:["string","integer"]},order:3}}}};var ar={config:Q,subscriptions:new atom$1.CompositeDisposable,async activate(){c.log("Activating package"),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:.apm-folder":async()=>{let{apmFolder:e}=await Promise.resolve().then(()=>(J(),G));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:app-data-folder":async()=>{let{appDataFolder:e}=await Promise.resolve().then(()=>(Y(),X));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:application-folder":async()=>{let{appFolder:e}=await Promise.resolve().then(()=>(ye(),we));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:configuration-folder":async()=>{let{configFolder:e}=await Promise.resolve().then(()=>(be(),ve));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:packages-folder":async()=>{let{packagesFolder:e}=await Promise.resolve().then(()=>(Pe(),xe));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:project-folders":async()=>{let{projectFolders:e}=await Promise.resolve().then(()=>(Fe(),ke));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:project-dependencies":async()=>{let{projectDependencies:e}=await Promise.resolve().then(()=>(Ae(),_e));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:resources-folder":async()=>{let{resourcesFolder:e}=await Promise.resolve().then(()=>(De(),Se));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:reveal-open-files":async()=>{let{revealFiles:e}=await Promise.resolve().then(()=>(T(),O));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:reveal-file":async()=>{let{revealFile:e}=await Promise.resolve().then(()=>(T(),O));await e();}}));},deactivate(){var e;c.log("Deactivating package"),(e=this.subscriptions)==null||e.dispose();},provideBrowse(){return c.log("Providing service"),K}};
module.exports=ar;