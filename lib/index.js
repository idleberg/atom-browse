'use strict';var child_process=require('child_process'),fs=require('fs'),os=require('os'),path=require('path'),electron=require('electron'),atom$1=require('atom');var Me=Object.create;var $=Object.defineProperty;var Oe=Object.getOwnPropertyDescriptor;var je=Object.getOwnPropertyNames;var Ce=Object.getPrototypeOf,Ee=Object.prototype.hasOwnProperty;var h=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+e+'" is not supported')});var l=(e,t)=>()=>(e&&(t=e(e=0)),t);var w=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),m=(e,t)=>{for(var r in t)$(e,r,{get:t[r],enumerable:true});},Re=(e,t,r,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of je(t))!Ee.call(e,o)&&o!==r&&$(e,o,{get:()=>t[o],enumerable:!(s=Oe(t,o))||s.enumerable});return e};var Le=(e,t,r)=>(r=e!=null?Me(Ce(e)):{},Re(!e||!e.__esModule?$(r,"default",{value:e,enumerable:true}):r,e));var z,B=l(()=>{z=class{name;styleSheet;constructor(e,t={}){if(typeof e!="string")throw new TypeError(`DeveloperConsole: name must be a string, got "${typeof e}"`);this.name=e,this.styleSheet=`
      background-color: ${t.backgroundColor||"darkgrey"};
      border-radius: 2px;
      color: ${t.color||"white"};
      line-height: 1.5;
      padding: 1px 4px;
      text-shadow: 0 1px 0px rgba(0, 0, 0, 0.2);
    `;}__console__(e,...t){atom!=null&&atom.inDevMode()&&(t.unshift(`%c${this.name}%c`,this.styleSheet,""),globalThis.console[e](...t));}debug(...e){this.__console__("debug",...e);}error(...e){this.__console__("error",...e);}info(...e){this.__console__("info",...e);}log(...e){this.__console__("log",...e);}trace(...e){this.__console__("trace",...e);}warn(...e){this.__console__("warn",...e);}};});var P,q=l(()=>{P="browse";});var d,F=l(()=>{B();q();d=new z(P,{backgroundColor:"mediumseagreen"});});var p={};m(p,{PLATFORM:()=>f,fileExists:()=>W,folderExists:()=>H,getAppName:()=>Ke,getConfig:()=>u,getPackagesDirs:()=>Qe,info:()=>x,isDirectory:()=>We,isFile:()=>He,showFolder:()=>Ge,showInFolder:()=>Je,warn:()=>Ve});function U(e,t){child_process.spawn(e,t,{detached:true,stdio:"ignore"}).unref();}async function W(e){try{await fs.promises.access(e,fs.constants.F_OK);}catch{return d.warn(`Skipping '${e}' \u2013 not found`),false}return  true}async function We(e){try{return (await fs.promises.lstat(e)).isDirectory()}catch{return  false}}async function He(e){try{return (await fs.promises.lstat(e)).isFile()}catch{return  false}}async function H(e){try{return (await fs.promises.stat(e)).isDirectory()}catch{return d.warn(`Skipping '${e}' \u2013 not found`),false}}function K(e,t){let r=[...e];if(r.includes("%path%")){let s=r.indexOf("%path%");r[s]=r[s].replace("%path%",t);}else r.push(t);return r}async function Ge(e){var r,s,o,a;if(!e.path.length||!await H(e.path))return;let t=u("customFileManager.fullPath");if(t){let n=K(u("customFileManager.openArgs"),e.path);!e.silent&&((r=e.message)!=null&&r.length)&&((s=e.name)!=null&&s.length)&&x(e.message??`Opening '${e.name}' in custom file manager`),U(t,n);}else {!e.silent&&((o=e.message)!=null&&o.length)&&((a=e.name)!=null&&a.length)&&x(e.message??`Opening '${e.name}' in ${Q()}`);try{await electron.shell.openPath(e.path);}catch{"openItem"in electron.shell&&electron.shell.openItem(e.path);}}}async function Je(e){var r,s;if(!e.path.length||!await W(e.path))return;let t=u("customFileManager.fullPath");if(t){let o=K(u("customFileManager.revealArgs"),e.path);!e.silent&&((r=e.message)!=null&&r.length)&&x(e.message??`Revealing \`${path.basename(e.path)}\` in custom file manager`),U(t,o);}else !e.silent&&((s=e.message)!=null&&s.length)&&x(e.message??`Revealing \`${path.basename(e.path)}\` in ${Q()}`),electron.shell.showItemInFolder(e.path);}function x(e,t=false){u("notify")==="all"&&atom.notifications.addInfo(`**${P}** ${e}`,{dismissable:t,icon:"check"}),d.info(`${e}`);}function Ve(e,t=false){u("notify")!=="none"&&atom.notifications.addWarning(`**${P}** ${e}`,{dismissable:t}),u("beep")&&atom.beep(),d.warn(`${e}`);}var f,Ke,u,Qe,Q,c=l(()=>{q();F();f=os.platform();Ke=()=>atom.getAppName().split(" ")[0]||"",u=(e="")=>atom.config.get(`browse.${e}`),Qe=()=>atom.packages.getPackageDirPaths().filter(t=>!t.includes("app.asar"));Q=()=>{switch(f){case "darwin":return "Finder";case "win32":return "Explorer";default:return "file manager"}};});var X={};m(X,{apmFolder:()=>tt});async function tt(){let{showFolder:e}=await Promise.resolve().then(()=>(c(),p)),t=path.dirname(atom.config.getUserConfigPath()),r=path.resolve(t,".apm");e({name:".apm Folder",path:r});}var Y=l(()=>{});var ee={};m(ee,{appDataFolder:()=>rt});async function rt(){let{getAppName:e,showFolder:t}=await Promise.resolve().then(()=>(c(),p)),r=e(),s;switch(f){case "darwin":s=path.resolve(os.homedir(),"Library","Application Support",r);break;case "win32":s=process.env.APPDATA?path.resolve(process.env.APPDATA,r):"";break;default:s=path.resolve(os.homedir(),".config",r);break}t({name:"App Data Folder",path:s});}var te=l(()=>{c();});var se=w((Qt,re)=>{var T=class{constructor(t){this.value=t,this.next=void 0;}},M=class{constructor(){this.clear();}enqueue(t){let r=new T(t);this._head?(this._tail.next=r,this._tail=r):(this._head=r,this._tail=r),this._size++;}dequeue(){let t=this._head;if(t)return this._head=this._head.next,this._size--,t.value}clear(){this._head=void 0,this._tail=void 0,this._size=0;}get size(){return this._size}*[Symbol.iterator](){let t=this._head;for(;t;)yield t.value,t=t.next;}};re.exports=M;});var ne=w((Gt,oe)=>{var st=se(),ot=e=>{if(!((Number.isInteger(e)||e===1/0)&&e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");let t=new st,r=0,s=()=>{r--,t.size>0&&t.dequeue()();},o=async(i,v,...b)=>{r++;let L=(async()=>i(...b))();v(L);try{await L;}catch{}s();},a=(i,v,...b)=>{t.enqueue(o.bind(null,i,v,...b)),(async()=>(await Promise.resolve(),r<e&&t.size>0&&t.dequeue()()))();},n=(i,...v)=>new Promise(b=>{a(i,b,...v);});return Object.defineProperties(n,{activeCount:{get:()=>r},pendingCount:{get:()=>t.size},clearQueue:{value:()=>{t.clear();}}}),n};oe.exports=ot;});var ce=w((Jt,ie)=>{var ae=ne(),A=class extends Error{constructor(t){super(),this.value=t;}},nt=async(e,t)=>t(await e),at=async e=>{let t=await Promise.all(e);if(t[1]===true)throw new A(t[0]);return  false},it=async(e,t,r)=>{r={concurrency:1/0,preserveOrder:true,...r};let s=ae(r.concurrency),o=[...e].map(n=>[n,s(nt,n,t)]),a=ae(r.preserveOrder?1:1/0);try{await Promise.all(o.map(n=>a(at,n)));}catch(n){if(n instanceof A)return n.value;throw n}};ie.exports=it;});var fe=w((Vt,O)=>{var le=h("path"),S=h("fs"),{promisify:pe}=h("util"),ct=ce(),lt=pe(S.stat),pt=pe(S.lstat),de={directory:"isDirectory",file:"isFile"};function me({type:e}){if(!(e in de))throw new Error(`Invalid type specified: ${e}`)}var ue=(e,t)=>e===void 0||t[de[e]]();O.exports=async(e,t)=>{t={cwd:process.cwd(),type:"file",allowSymlinks:true,...t},me(t);let r=t.allowSymlinks?lt:pt;return ct(e,async s=>{try{let o=await r(le.resolve(t.cwd,s));return ue(t.type,o)}catch{return  false}},t)};O.exports.sync=(e,t)=>{t={cwd:process.cwd(),allowSymlinks:true,type:"file",...t},me(t);let r=t.allowSymlinks?S.statSync:S.lstatSync;for(let s of e)try{let o=r(le.resolve(t.cwd,s));if(ue(t.type,o))return s}catch{}};});var he=w((Xt,j)=>{var ge=h("fs"),{promisify:dt}=h("util"),mt=dt(ge.access);j.exports=async e=>{try{return await mt(e),!0}catch{return  false}};j.exports.sync=e=>{try{return ge.accessSync(e),!0}catch{return  false}};});var ye=w((Yt,y)=>{var g=h("path"),D=fe(),we=he(),C=Symbol("findUp.stop");y.exports=async(e,t={})=>{let r=g.resolve(t.cwd||""),{root:s}=g.parse(r),o=[].concat(e),a=async n=>{if(typeof e!="function")return D(o,n);let i=await e(n.cwd);return typeof i=="string"?D([i],n):i};for(;;){let n=await a({...t,cwd:r});if(n===C)return;if(n)return g.resolve(r,n);if(r===s)return;r=g.dirname(r);}};y.exports.sync=(e,t={})=>{let r=g.resolve(t.cwd||""),{root:s}=g.parse(r),o=[].concat(e),a=n=>{if(typeof e!="function")return D.sync(o,n);let i=e(n.cwd);return typeof i=="string"?D.sync([i],n):i};for(;;){let n=a({...t,cwd:r});if(n===C)return;if(n)return g.resolve(r,n);if(r===s)return;r=g.dirname(r);}};y.exports.exists=we;y.exports.sync.exists=we.sync;y.exports.stop=C;});var be={};m(be,{appFolder:()=>ft});async function ft(){let{getConfig:e,showFolder:t}=await Promise.resolve().then(()=>(c(),p)),r=await Promise.resolve().then(()=>Le(ye())),s=path.dirname(path.resolve(process.execPath)),o;if(f==="darwin"&&e("openAppPackage")){let a=r.sync("Resources",{cwd:s,type:"directory"});o=a?path.dirname(a):s;}else o=s;t({name:"Application Folder",path:o});}var Pe=l(()=>{c();});var xe={};m(xe,{configFolder:()=>ht});async function ht(){let{showFolder:e}=await Promise.resolve().then(()=>(c(),p)),t=path.dirname(atom.config.getUserConfigPath());e({name:"Configuration Folder",path:t});}var Fe=l(()=>{});var ke={};m(ke,{packagesFolder:()=>wt});async function wt(){let{getPackagesDirs:e,showFolder:t}=await Promise.resolve().then(()=>(c(),p)),r=e();for(let s of r)t({name:"Packages Folder",path:s});}var _e=l(()=>{});var Ae={};m(Ae,{projectFolders:()=>yt});async function yt(){let{showFolder:e,warn:t}=await Promise.resolve().then(()=>(c(),p)),r=atom.project.getPaths();if(r.length===0)return t("Editor has no projects");for(let s of r)s.startsWith("atom://")||e({name:"Project Folder",path:s});}var Se=l(()=>{});var De={};m(De,{projectDependencies:()=>bt});async function bt(){let{getConfig:e,showFolder:t,warn:r}=await Promise.resolve().then(()=>(c(),p)),s=atom.project.getPaths();if(s.length===0)return r("Editor has no projects");let o=e("dependencyPaths");if(!o||!o.length)return r("No dependency folders specified in package configuration");await Promise.all(s.map(async a=>{a.startsWith("atom://")||await Promise.all(o.map(async n=>{let i=path.resolve(a,n);t({name:`\`${n}\``,path:i});}));}));}var $e=l(()=>{});var qe={};m(qe,{resourcesFolder:()=>Pt});async function Pt(){let{showFolder:e}=await Promise.resolve().then(()=>(c(),p)),t=atom.commandInstaller.getResourcesDirectory();e({name:"Resources Folder",path:t});}var Ie=l(()=>{});var E={};m(E,{revealFile:()=>Te,revealFiles:()=>xt});async function Te(e){var o,a;let{showInFolder:t,warn:r}=await Promise.resolve().then(()=>(c(),p)),s=e||atom.workspace.getActiveTextEditor()||atom.workspace.getActivePaneItem();if(s&&(s.constructor.name==="TextEditor"||s.constructor.name==="ImageEditor")){let n=((a=(o=s.buffer)==null?void 0:o.file)==null?void 0:a.path)??"";n?t({path:n}):r("File hasn't been saved yet");}else r("Active pane is not an editor");}async function xt(){let{warn:e}=await Promise.resolve().then(()=>(c(),p)),t=atom.workspace.getPaneItems();t.length?await Promise.all(t.map(r=>Te(r))):e("No active files");}var R=l(()=>{});F();async function G(e,t){let{isDirectory:r,isFile:s,showFolder:o,showInFolder:a}=await Promise.resolve().then(()=>(c(),p));await s(e)?a({path:e,...t}):await r(e)&&o({name:path.basename(e),path:e,...t});}async function J(e){if(typeof e=="string")return G(e);let t=Array.isArray(e.target)?e.target:[e.target];for(let r of t){if(typeof r!="string"){d.warn(`Skipping: target path is of type ${typeof r}, should be string`);continue}await G(r,{message:e.message,silent:e.silent});}}c();function Ye(){return f?{title:"Open App Package",description:`Specify whether *Browse: Application Folder* opens the \`${atom.getAppName()}.app\` package or the executable that started the Node.js process (i.e. \`Atom Helper\`)`,type:"boolean",default:true,order:3}:{}}var V={notify:{title:"Notifications",description:"Specify which types of notifications to display",type:"string",enum:[{value:"none",description:"None"},{value:"warnings",description:"Warnings Only"},{value:"all",description:"All Notifications"}],default:"all",order:1},dependencyPaths:{title:"Dependency Paths",description:"Specify dependency folders that can be opened using the *Browse: Dependency Folders* command",type:"array",default:["bower_components","node_modules","vendor"],items:{type:["string"]},order:2},beep:{title:"Beep on error",description:"Play beep sound when errors occur",type:"boolean",default:true,order:3},openAppPackage:Ye(),customFileManager:{title:"Custom File Manager Options",type:"object",order:5,properties:{fullPath:{title:"Full Path",description:"Specify the full path to a custom file manager",type:"string",default:"",order:1},openArgs:{title:"Open Arguments",description:"Specify custom arguments to open a folder. The use of the `%path%` placeholder is optional.",type:"array",default:[],items:{type:["string","integer"]},order:2},revealArgs:{title:"Reveal Arguments",description:"Specify custom arguments to reveal a file. The use of the `%path%` placeholder is optional.",type:"array",default:[],items:{type:["string","integer"]},order:3}}}};F();var ir={config:V,subscriptions:new atom$1.CompositeDisposable,async activate(){d.log("Activating package"),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:.apm-folder":async()=>{let{apmFolder:e}=await Promise.resolve().then(()=>(Y(),X));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:app-data-folder":async()=>{let{appDataFolder:e}=await Promise.resolve().then(()=>(te(),ee));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:application-folder":async()=>{let{appFolder:e}=await Promise.resolve().then(()=>(Pe(),be));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:configuration-folder":async()=>{let{configFolder:e}=await Promise.resolve().then(()=>(Fe(),xe));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:packages-folder":async()=>{let{packagesFolder:e}=await Promise.resolve().then(()=>(_e(),ke));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:project-folders":async()=>{let{projectFolders:e}=await Promise.resolve().then(()=>(Se(),Ae));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:project-dependencies":async()=>{let{projectDependencies:e}=await Promise.resolve().then(()=>($e(),De));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:resources-folder":async()=>{let{resourcesFolder:e}=await Promise.resolve().then(()=>(Ie(),qe));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:reveal-open-files":async()=>{let{revealFiles:e}=await Promise.resolve().then(()=>(R(),E));await e();}})),this.subscriptions.add(atom.commands.add("atom-workspace",{"browse:reveal-file":async()=>{let{revealFile:e}=await Promise.resolve().then(()=>(R(),E));await e();}}));},deactivate(){var e;d.log("Deactivating package"),(e=this.subscriptions)==null||e.dispose();},provideBrowse(){return d.log("Providing service"),J}};
module.exports=ir;